---
import type { Holiday } from "../../interfaces/holidays/holiday.ts";

interface Props {
  holiday: Holiday & { id: string };
}

const { holiday } = Astro.props;

const schema = {
  "@context": "https://schema.org",
  "@type": "Event",
  "name": holiday.description || "Feriado",
  "startDate": holiday.date || "",
  "endDate": holiday.date || "",
  "description": `${holiday.description} - Tipo: ${holiday.type}. Respaldo legal: ${holiday.legalSupport}`,
  "eventStatus": "https://schema.org/EventScheduled",
  "url": holiday.slug ? `https://feriados-chile.com/${holiday.slug}` : "https://feriados-chile.com",
  "location": {
    "@type": "Place",
    "name": "Chile",
    "address": {
      "@type": "PostalAddress",
      "addressCountry": "CL"
    }
  },
  "organizer": {
    "@type": "Organization",
    "name": "Gobierno de Chile",
    "url": "https://www.gob.cl"
  },
  "image": holiday.icon ? `data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><text x="50%" y="50%" font-size="100" text-anchor="middle" dominant-baseline="middle">${holiday.icon}</text></svg>` : undefined,
  "offers": {
    "@type": "Offer",
    "url": holiday.slug ? `https://feriados-chile.com/${holiday.slug}` : "https://feriados-chile.com",
    "price": "0",
    "priceCurrency": "CLP",
    "availability": "https://schema.org/PreOrder"
  }
};

// Filtrar valores undefined
const cleanSchema = JSON.parse(JSON.stringify(schema));
---

<script type="application/ld+json" set:html={JSON.stringify(cleanSchema)}></script>
